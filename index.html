<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Canvas test</title>
	<meta http-equiv="Content-Type" content="text/html">
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<meta name="author" content="GreenImp Web - greenimp.co.uk">

	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=IE8">

	<style>
		body{
			margin:0;
			padding:0;
			background:#C1D3EE;
		}

		canvas#testCanvas{
			display:block;;
			margin:20px auto;
			width:500px;
			height:500px;
			box-shadow:-5px 5px 5px #666;
		}
	</style>
</head>

<body>
	<canvas width="500" height="500" id="testCanvas"></canvas>

	<script>
		var canvasSize = {
			width:500,
			height:500
		};

		// image size, in cm
		var imageSize = {
			width:30,
			height:40
		};
		// the width of the frame in cm
		var frameWidth = 4;
		// the mount border in cm
		var mountBorder = 5;


		// convert the image size into px
		var pxSize = {
			width:imageSize.width*10,
			height:imageSize.height*10
		};
		var pxFrameWidth = frameWidth*10;
		var pxMountBorder = mountBorder*10;

		// calculate the total size of the frame
		var frameSize = {
			width:pxSize.width + (pxFrameWidth*2) + (pxMountBorder*2),
			height:pxSize.height + (pxFrameWidth*2) + (pxMountBorder*2)
		};

		if((frameSize.width > canvasSize.width) || (frameSize.height > canvasSize.height)){
			// frame is too big for the canvas - porportionally resize it

		}


		var canvas = document.getElementById('testCanvas'),
			ctx = canvas.getContext('2d'),
			image = new Image();
		image.src = 'frames/photo.jpg';
		var frame = new Image();   // Create new img element
		frame.onload = function(){
			// execute drawImage statements here
			var actualFrameWidth = frame.width,
				actualFrameHeight = frame.height,
				aspectRatio = actualFrameWidth / actualFrameHeight,
				frameWidth = 50,
				frameHeight = Math.floor(frameWidth / aspectRatio);
			var x = canvas.width / 2;
			var y = canvas.height / 2;
			var degrees = 0;

			/**
			 * draw the mount
			 */
			ctx.fillStyle = '#fff';
			ctx.fillRect(0, 0, 500, 500);

			var x1 = (frameSize.width/2)-(pxSize.width/2)-0.5,
				x2 = (frameSize.width/2)+(pxSize.width/2)+10+0.5,
				y1 = (frameSize.height/2)-(pxSize.height/2)-0.5,
				y2 = (frameSize.height/2)+(pxSize.height/2)+10+0.5;
			ctx.lineWidth = 1;
			ctx.strokeStyle = '#eee';
			ctx.beginPath();
			ctx.moveTo(x1, y1);
			ctx.lineTo(x1, y2);
			ctx.lineTo(x2, y2);
			ctx.lineTo(x2, y1);
			ctx.closePath();
			ctx.stroke();

			ctx.beginPath();
			ctx.strokeStyle = '#efefef';
			ctx.lineWidth = 2;
			x1++;
			x2--;
			y1++;
			y2--;
			ctx.moveTo(x1, y1);
			ctx.lineTo(x1, y2);
			ctx.lineTo(x2, y2);
			ctx.lineTo(x2, y1);
			ctx.closePath();
			ctx.stroke();

			/**
			 * Draw the image(s)
			 */
			x1 += 5;
			y1 += 5;
			ctx.drawImage(image, x1, y1, pxSize.width, pxSize.height);


			/**
			 * Draw the frame
			 */
			// left
			var length = 0;
			var count = 0;
			for(count = 0; length < 500; count++){
				ctx.drawImage(frame, 0, frameHeight*count, frameWidth, frameHeight);
				length += frameHeight;
			}

			// right
			degrees = (Math.PI/180) * 180;
			ctx.translate(x, y);
			ctx.rotate(degrees);

			length = 0;
			for(count = 0; length < 500; count++){
				ctx.drawImage(frame, -x, -y+(frameHeight*count), frameWidth, frameHeight);
				length += frameHeight;
			}

			ctx.rotate(-degrees);
			ctx.translate(-x, -y);


			ctx.save();
			ctx.strokeStyle = '#f00';
			ctx.beginPath();
			ctx.moveTo(0,0);
			ctx.lineTo(500,0);
			ctx.lineTo(500-frameWidth, frameWidth);
			ctx.lineTo(500-frameWidth, 500-frameWidth);
			ctx.lineTo(500, 500);
			ctx.lineTo(0, 500);
			ctx.lineTo(frameWidth, 500-frameWidth);
			ctx.lineTo(frameWidth, frameWidth);
			ctx.closePath();
			ctx.clip();

			degrees = (Math.PI/180) * 90;
			ctx.translate(x, y);
			ctx.rotate(degrees);

			// top
			length = 0;
			for(count = 0; length < 500; count++){
				ctx.drawImage(frame, -x, -y+(frameHeight*count), frameWidth, frameHeight);
				length += frameHeight;
			}

			// bottom
			length = 0;
			for(count = 0; length < 500; count++){
				ctx.drawImage(frame, x-frameWidth, -y+(frameHeight*count), frameWidth, frameHeight);
				length += frameHeight;
			}

			ctx.rotate(-degrees);
			ctx.translate(-x, -y);
			ctx.restore();
		};
		frame.src = 'frames/frame1.jpg'; // Set source path
	</script>
</body>
</html>